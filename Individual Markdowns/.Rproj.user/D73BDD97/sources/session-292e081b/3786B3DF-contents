---
title: "STA108 Term Project"
author: "Gabriel Jones"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
# Libraries

suppressPackageStartupMessages({
library(readr)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(knitr)
library(plotrix)
library(ggpubr)
library(MASS)
library(lindia)
library(leaps)
library(car)
library(tidyr)
})  
```

```{r}
# Load Data
countries <- read.csv("countries.csv")
countries <- janitor::clean_names(countries)

# Select Subset
n <- nrow(countries)
set.seed(39) # HATSUNE MIKU
subset_id <- sample(n, 0.8*n)
countries <- countries[subset_id, ]

# Transformations
countries_new <- countries %>%
  mutate(co2=log(co2))%>%
  mutate(elderly_pop=log(elderly_pop))%>% 
  mutate(gdp=log(gdp))%>%
  mutate(internet=log(internet))
```

## Introduction

In this project, we are interested in building a parsimonious model to estimate the life expectancy of individuals depending on various aspects of their residence country. The factors that will be considered for this estimation include: Land Area, Population, Rural Population, Health Care Expenditures, Internet Access, Birth Rate, Elderly Population, CO2 Emissions, GDP, and Cell Phone Subscriptions. The data set provided contains this information for 148 different countries. 

## Results

From our analysis, the variables we found to be most accurate in predicting life expectancy were: Rural Population, Health, Internet, Birth Rate, and Elderly Population. We found that the variables Internet and Elderly Population had a logistic relationship with life expectancy, while the other three variables exhibited a linear relationship. The final model had $R^2 = 0.7838$. The elderly population, birth rate, and % rural population were shown to have a negative relationship with life expectancy, thus, minimizing these factors would work to maximize life expectancy. Below is the model found to best predict life expectancy along with explicit definitions for each predictor.

$X_1=$ % Rural Population

$X_2=$ % of $ For Healthcare

$X_3=$ % of Population With Internet Access

$X_4=$ Birth Rate per 1000 Individuals

$X_5=$ % Elderly Population

$$
LifeExpectancy = \beta_0 + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}log(X_{3}) +  \beta_{4}X_{4} + \beta_{5}log(X_{5}) + \epsilon
$$

Below details our estimates for $\beta_1,...,\beta_5$ 

```{r}
best_lm <- lm(life_expectancy ~ rural + health + internet + 
                birth_rate + elderly_pop, data=countries_new)

best_lm_summary <- summary(best_lm)
output <- data.frame(
  "Beta"=c("b0", "b1", "b2", "b3", "b4", "b5"),
  "Estimate"= best_lm_summary$coefficients[,1]
  )
output <- output%>%
  pivot_wider(names_from="Beta", values_from="Estimate")%>%
  as.data.frame(.)
rownames(output) <- "Estimate"

kable(output)
```

## Methods

<Our approach towards achieving our ideal model>

## Summary

## Appendix

