---
title: "STA108Project_Gabe&ELLIESUFFER"
author: "Ellie Chareonsuphiphat"
date: "2023-11-23"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
# Libraries
library(readr)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(knitr)
library(plotrix)
library(ggpubr)
library(MASS)
library(lindia)
library(leaps)
```

```{r}
# Load Data
countries <- read.csv("../countries.csv")
countries <- janitor::clean_names(countries)
```

## Single Linear Regression Models

Create a single linear regression model for Life Expectancy ~ X. Generate all necessary plots for regression analysis.

Variables to change:

Note: All variables that need to be changed will have a "#<change>" next to the line of code

- x.lab : Name of X variable. Capitalize the first letter, use full names, use space instead of "_". (Ex. land_area -> Land Area) 

- x.dat : Linear Model X variable

- Linear Model Names: Name of X variable followed by "_lm" and "_lm_summary" respectively.

- The corresponding variable name in the "#Display Values" section

**Life Expectancy ~ Land Area**

```{r}
# Variable Names
x.lab <- "Land Area" #<change>
x.dat <- countries$land_area #<change>

y.lab <- "Life Expectancy"
title <- paste(y.lab, "~", x.lab)

  
# Create Linear Model
landarea_lm <- lm(life_expectancy ~ x.dat, data=countries) #<change>
landarea_lm_summary <- summary(landarea_lm) #<change>
row.names(landarea_lm_summary$coefficients) <- c("(Intercept)", x.lab) #<change>


# Display Values
kable(landarea_lm_summary$coefficients, #<change>
      caption=title)


# Scatterplot
landarea_scatter <- countries%>% #<change>
  ggplot(aes(y=life_expectancy, 
             x=x.dat))+
  geom_point(color='cyan4')+
  geom_smooth(method='lm', color="black")+
  labs(title=title,
       x=x.lab,
       y=y.lab)
ggsave(filename=paste(x.lab, "Scatterplot.png"), device = "png", path=paste0("../Plots/", x.lab))


# Residual Plot
landarea_resid <- countries%>%  #<change>
  ggplot(aes(x=fitted(landarea_lm), #<change>
             y=residuals(landarea_lm) #<change>
             ))+
  geom_point(color="darkgoldenrod", shape=21)+
  geom_hline(yintercept=0)+
  labs(title="Residuals Against Fitted Values",
       x="Fitted Values",
       y="Residuals")
ggsave(filename=paste(x.lab, "Residual Plot.png"), device = "png", path=paste0("../Plots/", x.lab))


# Residual QQ Plot
landarea_ResidQQ <- landarea_lm%>% #<change>
  ggplot(aes(sample=residuals(landarea_lm)))+ #<change>
  geom_qq(color="brown3", size=1.3)+
  geom_qq_line()+
  labs(title="Residual QQ Plot",
       x="Theoretical Quantiles",
       y="Sample Quantiles")
ggsave(filename=paste("Residual QQ Plot.png"), device = "png", path=paste0("../Plots/", x.lab))


# Predictor QQ Plot
landarea_QQ <- landarea_lm%>% #<change>
  ggplot(aes(sample=x.dat))+
  geom_qq(color="forestgreen", size=1.3)+
  geom_qq_line()+
  labs(title=paste(x.lab, "QQ Plot"),
       x="Theoretical Quantiles",
       y="Sample Quantiles")
ggsave(filename=paste(x.lab, "QQ Plot.png"), device = "png", path=paste0("../Plots/", x.lab))


ggarrange(landarea_scatter, landarea_resid) #<change>
ggarrange(landarea_QQ, landarea_ResidQQ) #<change>
```



